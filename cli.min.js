import yargs from 'yargs';
import { hideBin } from 'yargs/helpers';
import utils from './src/utils.js';
import main from './src/index.js';

const cmder = yargs(hideBin(process.argv))
  .command(
    'deploy',
    'Deploy your files by searching for "commands" directory.',
    () => {},
    cmder =>
      cmder['_'][0] === 'deploy'
        ? main(cmder)
        : utils.spinner().info('Use --help to show menu.')
  )
  .option('debug', {
    type: 'boolean',
    description: 'Run in debug mode.',
    default: false
  })
  .option('cwd', {
    type: 'string',
    description: 'Directory to searches for commands.',
    default: process.cwd()
  })
  .option('test', {
    type: 'boolean',
    description:
      'Deploy commands for a Test Guild (Requires GUILD_TEST_ID env variable).',
    default: false
  })
  .demandCommand(1)
  .parse();